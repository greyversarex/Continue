Тема: Полный аудит и синхронизация бэкенда с фронтендом админ-панели.
Цель: Привести всю бэкенд-логику (Prisma-схема, контроллеры, сервисы) в полное соответствие с визуальными формами, которые существуют в HTML/JS коде админ-панели. Фронтенд-формы являются единственным «источником правды».
План Работы:
Фаза 1: Аудит и Ремонт по каждому разделу админ-панели.
Тебе необходимо последовательно пройти по каждому разделу админ-панели, где есть функционал создания или редактирования сущностей (Туры, Гиды, Отели и т.д.), и выполнить для каждого из них следующий алгоритм:
Пример алгоритма на разделе «Туры»:
Анализ Фронтенд-формы:
Найди HTML и JS файлы, отвечающие за форму создания и редактирования Тура.
Составь полный список всех полей, которые видит и заполняет администратор в этой форме. Включи все <input>, <select>, <textarea>, загрузчики файлов и другие элементы.
Сравнение с Бэкендом:
Сравни полученный список полей с моделью Tour в файле prisma/schema.prisma.
Сравни этот же список с кодом в контроллере, который отвечает за обработку данных из этой формы (вероятно, функции createTour и updateTour).
Отчет о Несоответствиях:
Предоставь мне отчет о всех найденных расхождениях. Например: «В форме есть поле tour_duration (длительность тура), но в Prisma-модели Tour такого поля нет» или «Контроллер createTour не принимает и не сохраняет данные из поля main_photo».
Синхронизация и Ремонт:
Schema: Внеси необходимые изменения в prisma/schema.prisma, чтобы модель полностью соответствовала форме.
Controller: Исправь код контроллера, чтобы он корректно принимал, обрабатывал и сохранял в базу данных все поля из формы.
Data Retrieval: Убедись, что при открытии формы для редактирования существующего тура, все сохраненные данные из базы корректно загружаются обратно в свои поля в форме.
Инструкция:
Повтори этот четырехшаговый алгоритм (Анализ -> Сравнение -> Отчет -> Ремонт) для АБСОЛЮТНО КАЖДОЙ СУЩНОСТИ, которая создается или редактируется через админ-панель. Включая, но не ограничиваясь:
Туры (Tours)
Отели (Hotels)
Гиды (Guides)
Водители (Drivers)
Категории (Categories)
Новости (News)
Слайды (Slides)
... и всех остальных.
Фаза 2: Сквозная Проверка Пути Данных.
После того как ты завершишь ремонт по всем разделам в Фазе 1, проведи финальную проверку. Для каждой сущности (Тур, Гид и т.д.) убедись, что данные, введенные в форме:
Корректно сохраняются в базе данных.
Корректно отображаются во всех предназначенных для них местах на публичной части сайта (например, данные из формы Тура должны правильно появляться на карточке тура на главной странице и на детальной странице самого тура).
Начни с раздела «Туры». Предоставь мне сначала отчет о несоответствиях (пункт 3), и после моего подтверждения приступай к ремонту (пункт 4). Затем переходи к следующему разделу.